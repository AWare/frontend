@import common.commercial.hosted.HostedArticlePage
@(page: HostedArticlePage)(implicit request: RequestHeader)
@import common.commercial.hosted.hardcoded.Support.makeshiftPage
@import views.html.hosted._
@import common.{AnalyticsHost, CanonicalLink, LinkTo}
@import conf.Configuration
@import views.support.OmnitureAnalyticsData
@import views.support.FBPixel

<!doctype html>
<html AMP>
    <head>
        @* "utf-8" meta tag needs to be first according to AMP spec *@
        <meta charset="utf-8">
        <meta name="amp-3p-iframe-src" content="https://www.theguardian.com/amp/remote.html">
        @fragments.metaData(page, amp = true)
        <title>@views.support.Title(page)</title>
        @fragments.amp.stylesheets.main(page.metadata)
        <script custom-element="amp-font" src="https://cdn.ampproject.org/v0/amp-font-0.1.js" async></script>
        <script custom-element="amp-twitter" src="https://cdn.ampproject.org/v0/amp-twitter-0.1.js" async></script>
        <script custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js" async></script>
        <script custom-element="amp-list" src="https://cdn.ampproject.org/v0/amp-list-0.1.js" async ></script>
        @* Required for outbrain served in an amp-iframe *@
        <script custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js" async></script>
        <script custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js" async></script>
        <script src="https://cdn.ampproject.org/v0.js" async></script>
    </head>
    <body>
        @*
        Baseline pageview confidence pixel.
        This, along with the corresponding pixels for GA/Omniture/Ophan,
        are used to generate the confidence graphs on the frontend dashboard.
        *@
        <amp-pixel src="@{Configuration.debug.beaconUrl}/count/pv.gif"></amp-pixel>

            @defining(s"${request.host}${request.path}") { path =>
                @defining({
                    val params = OmnitureAnalyticsData(page, "No Javascript", path, "GoogleAMP", Map(("r", "DOCUMENT_REFERRER")))
                    val omnitureAccount = Configuration.javascript.pageData("guardian.page.omnitureAccount")
                    s"${AnalyticsHost()}/b/ss/$omnitureAccount/1/H.25.3/?$params"
                }) { omnitureCall =>
                    <amp-pixel src="@Html(omnitureCall)"></amp-pixel>
                    @* Omniture pageview confidence pixel *@
                    <amp-pixel src="@{Configuration.debug.beaconUrl}/count/pva.gif"></amp-pixel>
                }
            }
        <amp-pixel src="//www.facebook.com/tr?id=@FBPixel.account&ev=PageView&noscript=1"></amp-pixel>
        <amp-analytics config="https://ophan.theguardian.com/amp.json"></amp-analytics>

            @fragments.amp.hostedGoogleAnalytics(page)

        <amp-analytics id="comscore" type="comscore">
            <script type="application/json">{ "vars": { "c2": "6035250" } }</script>
        </amp-analytics>

        <div class="main-body">
            <!--[if (gt IE 9)|(IEMobile)]><!-->
            <style>
                .hosted-tone {
                    color: @{page.campaign.fontColour.brandColour};
                }

                .hosted-tone-bg {
                    background-color: @{page.campaign.fontColour.brandColour};
                }

                .hosted-tone-btn {
                    color: @{page.campaign.fontColour.brandColour};
                    border: 1px solid @{page.campaign.fontColour.brandColour};
                }

                .hosted__banner .hosted-tone-btn,
                .hosted-tone-btn:focus,
                .hosted-tone-btn:hover {
                    background-color: @{page.campaign.fontColour.brandColour};
                }

                .hosted-page .hosted__link {
                    color: @{page.campaign.fontColour.brandColour};
                }

                .survey-container .survey-text__header {
                    background-color: @{page.campaign.fontColour.brandColour};
                }

                .survey-container::before {
                    border-bottom-color: @{page.campaign.fontColour.brandColour};
                }

                .hosted-article-page p.intro + p::first-letter {
                    background-color: @{page.campaign.fontColour.brandColour};
                }

                .from-content-api ul > li:before {
                    background-color: @{page.campaign.fontColour.brandColour};
                }

                /* To prevent video element from jumping */
                video {
                    width: 370px;
                }

                @@media (min-width: 740px) { /* Tablet bp and above */
                    video {
                        width : 600px;
                    }
                }
            </style>
            <!--<![endif]-->

            @guardianHostedHeader(if(page.campaign.fontColour.shouldHaveBrightFont) "hosted-article-page hosted-page--bright" else "hosted-article-page", page, isAMP = true)
            <div class="hosted-page l-side-margins hosted__side hosted-article-page @if(page.campaign.fontColour.shouldHaveBrightFont) {hosted-page--bright}">

                <article id="article" data-test-id="article-root" class="content content--article has-feature-showcase-element section-stage content--advertisement-feature" role="main">
                    <div class="media-primary media-content media-primary--showcase" style="background-image: url(@{page.mainPicture});">
                        <div class="gs-container">
                            <h2 class="title content__main-column">@{page.title}</h2>
                        </div>
                        <span class="caption hosted-tone">@{page.mainPictureCaption}</span>
                    </div>
                    <div class="content__main">
                        <div class="gs-container">
                            <div class="content__main-column content__main-column--article js-content-main-column">
                                <div class="content__meta-container js-content-meta js-football-meta u-cf content__meta-container--showcase">
                                    <div class="meta__extras" data-component="share">
                                        @guardianHostedShareButtons(page)
                                    </div>
                                </div>

                                <div class="content__article-body from-content-api js-article__body">
                                    <p class="intro">@Html(page.standfirst)</p>

                                    @page.pageName match {
                                        case "meet-the-characters-of-zootropolis" => { @zootropolisPage(page) }
                                        case "overview" => { @singaporeF1Overview() }
                                        case "offtrack" => { @singaporeF1Offtrack() }
                                        case "packages" => { @singaporeF1Packages() }
                                        case _ => { @Html(page.body) }
                                    }

                                </div>
                                <div class="hide-on-desktop">
                                @if(page.nextPages.nonEmpty) {
                                    @hostedOnwardJourney(page.nextPages.map { nextPage =>
                                        makeshiftPage(nextPage, page.campaign)
                                    }, 2, 4)
                                } else {
                                    <div class="js-onward-placeholder"></div>
                                }
                                </div>
                                <div class="hosted__standfirst">
                                    <div class="hosted__terms">â€‹Hosted content is used to describe content that is paid for and supplied by the advertiser.
                                    </div>
                                </div>
                            </div>
                            <div class="content__secondary-column">
                            @if(page.nextPages.nonEmpty) {
                                @hostedOnwardJourney(page.nextPages.map { nextPage =>
                                    makeshiftPage(nextPage, page.campaign)
                                }, 2, 4)
                            } else {
                                <div class="js-onward-placeholder"></div>
                            }
                            </div>
                        </div>
                    </div>
                </article>

                @guardianHostedCta(page, page.cta)

                <amp-font
                    layout="nodisplay"
                    font-family="Guardian Egyptian Web"
                    timeout="3000"
                    on-error-remove-class="guardian-egyptian-loading"
                    on-error-add-class="guardian-egyptian-missing"
                    on-load-remove-class="guardian-egyptian-loading"
                    on-load-add-class="guardian-egyptian-loaded">
                </amp-font>

        </div>
    </body>
</html>
