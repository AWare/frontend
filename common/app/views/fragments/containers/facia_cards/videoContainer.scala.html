@(containerDefinition: layout.FaciaContainer, frontProperties: model.FrontProperties)(implicit requestHeader: RequestHeader)

@import common.LinkTo
@import model.{VideoPlayer, ImageOverride, FaciaDisplayElement}
@import views.support.{ImgSrc, Video700}
@import layout.{ColumnAndCards, ContentCard, FaciaCardAndIndex, FaciaCardHeader}
@import views.html.fragments.items.facia_cards.item
@import views.html.fragments.items.elements.facia_cards.{itemImage, title}
@import views.html.fragments.media.{video, formattedDuration}

<div class="fc-container__inner">
    <h2 class="video-title fc-container__header__title">
        <a href="@containerDefinition.href">@containerDefinition.displayName</a>
    </h2>
</div>

<div class="video-playlist video-playlist--0 js-video-playlist"
     data-number-of-videos="@(containerDefinition.collectionEssentials.items.zipWithIndex.length - 1)">
    <div class="video-playlist__control video-playlist__control--prev js-video-playlist-prev">
        @fragments.inlineSvg("chevron-left", "icon", Seq("video-playlist__icon"))
    </div>
    <div class="video-playlist__control video-playlist__control--next js-video-playlist-next">
        @fragments.inlineSvg("chevron-right", "icon", Seq("video-playlist__icon"))
    </div>

    <ul class="u-unstyled video-playlist__inner">
        <li class="video-playlist__item video-title video-title--leftcol fc-container__header__title">
            <a class="video-title__link" href="@containerDefinition.href">@containerDefinition.displayName</a>
        </li>

        @containerDefinition.collectionEssentials.items.zipWithIndex.map { case (item, index) =>
            @if(item.header.isVideo) {
                <li class="video-playlist__item video-playlist__item--@index">
                    @item.properties.maybeContent.map { content => 
                        @defining(VideoPlayer(
                            content.elements.mainVideo.get,
                            Video640,
                            item.header.headline,
                            autoPlay = false,
                            showControlsAtStart = false,
                            SupportedUrl.fromFaciaContent(item),
                            Some(false)
                        )) { player =>
                            <div class="fc-item__media-wrapper u-faux-block-link__promote media__container--hidden js-video-player">
                                <div class="fc-item__video-container">
                                    @video(player, false, false)
                                </div>
                            </div>
                            @content.elements.mainVideo.map { video =>
                                <div class="fc-item__video-fallback media__placeholder--active js-video-placeholder gu-media__fallback">
                                    <div class="@RenderClasses("fc-item__video-play", "media__placeholder--hidden", "vjs-big-play-button", "js-video-play-button")"><span class="vjs-control-text"></span></div>
                                    <div class="fc-item__media-wrapper">
                                        <div class="fc-item__image-container u-responsive-ratio inlined-image">
                                        @InlineImage.fromFaciaContent(item).map { fallbackImage =>
                                            @fallbackImage.imageMedia
                                            <img src="@Video700.bestFor(fallbackImage.imageMedia)" />
                                        }
                                        </div>
                                    </div>
                                </div>
                                <div class="video-playlist__content">
                                    <div class="video-playlist__headline">
                                        @title(FaciaCardHeader.fromTrail(item, None), 0, 0, null, None, false)
                                        @if(item.properties.showByline) {
                                            <div class="fc-item__byline">@item.properties.byline</div>
                                        }
                                    </div>
                                    @formattedDuration(video.videos)
                                </div>
                            }
                        }
                    }
                </li>
            }
        }
    </ul>
</div>
