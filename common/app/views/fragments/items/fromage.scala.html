@(trail: Trail, index: Int, imageAdjustOverride: Option[String] = None)(implicit request: RequestHeader)

@defining((VisualTone(trail), imageAdjustOverride.getOrElse(trail.imageAdjust))) { case (tone, imageAdjust) =>
    <div
        class="@GetClasses.forFromage(trail, imageAdjust)"
        @trail.discussionId.map{ id =>
            data-discussion-id="@id"
            data-discussion-closed="@trail.isClosedForComments"
        }
        data-link-name="trail | @{index + 1}">

        <div class="fromage__container">
            <a href="@LinkTo{@trail.url}" class="fromage__link" data-link-name="article">
                @if(imageAdjust != Some("hide")) {
                    @trail.trailPicture(5,3).map{ imageContainer =>
                        @ImgSrc.imager(imageContainer, Item620).map { imgSrc =>
                            <div class="fromage__media-wrapper fromage__media-wrapper--first">
                                <div class="fromage__image-container u-responsive-ratio@if(imageAdjust == "boost"){ js-image-upgrade inlined-image" data-src="@imgSrc}">
                                    @if(imageAdjust == "boost") {
                                        @Item300.bestFor(imageContainer).map{ url => <img src="@url" class="responsive-img" alt="" /> }
                                    } else {
                                        @Item220.bestFor(imageContainer).map{ url => <img src="@url" alt="" /> }
                                    }
                                </div>
                            </div>
                        }
                    }
                }
                @fragments.items.elements.title(trail, index, 0)
            </a>
            @if(tone == "comment") {
                @trail.byline.map { byLine =>
                    <p class="fromage__byline tone-colour">@Html(byLine)</p>
                }
            }
            @if(imageAdjust == "default") {
                @trail.trailPicture(5,3).map{ imageContainer =>
                    @ImgSrc.imager(imageContainer, Item620).map { imgSrc =>
                        <a href="@LinkTo{@trail.url}" data-link-name="article">
                            <div class="fromage__media-wrapper fromage__media-wrapper--second">
                                <div class="fromage__image-container u-responsive-ratio">
                                    @Item220.bestFor(imageContainer).map{ url => <img src="@url" alt="" /> }
                                </div>
                            </div>
                        </a>
                    }
                }
            }
            @trail.trailText.map { text =>
                <div class="fromage__standfirst">@Html(text)</div>
            }
            @fragments.items.elements.supporting(trail.supporting, style = "fit")

            @* Display meta only if there is a discussion *@
            @* @trail.discussionId.map{ id =>
                @fragments.items.elements.meta(trail)
            } *@
            <div class="item__meta">
            <time class="item__timestamp js-item__timestamp js-hidden" itemprop="datePublished" datetime="2014-04-16T12:13:00+0000" data-timestamp="1397650380000" data-relativeformat="short">
            <i class="i i-clock-light-grey"></i>
            <span class="timestamp__text"><span class="u-h">Published: </span>16 Apr 2014</span>
            </time>
            <span class="trail__count trail__count--commentcount"><a href="/world/2014/apr/16/pro-russian-separatists-seize-ukrainian-armoured-vehicles#comments" data-link-name="Comment count"><i class="i i-comment-light-grey"></i>1784<span class="u-h"> comments</span></a></span></div>
        </div>

    </div>
}
