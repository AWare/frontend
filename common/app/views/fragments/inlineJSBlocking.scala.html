@(metaData: model.MetaData)(implicit request: RequestHeader)
@import conf.switches.Switches._
@import common.InlineJs

<!--[if lt IE 9]>
    <script src="@Static("javascripts/components/html5shiv/html5shiv.js")"></script>
<![endif]-->

@fragments.omnitureScript(Some(metaData))

@* NOTE the order of these includes is important  *@
<script id="gu">
    // polyfills
    @Html(templates.inlineJS.blocking.js.polyfills().body)

    // determine whether to run enhanced JS
    @InlineJs.withFileNameHint(templates.inlineJS.blocking.js.shouldEnhance(metaData).body, "shouldEnhance.js")

    // page config
    @Html(templates.inlineJS.blocking.js.config(metaData).body)

    // analytics code
    @InlineJs.withFileNameHint(templates.inlineJS.blocking.js.analytics().body, "analytics.js")

    // apply render conditions
    @InlineJs.withFileNameHint(templates.inlineJS.blocking.js.applyRenderConditions().body, "applyRenderConditions.js")

    // try and load fonts before we use the stylesheets
    @if(FontSwitch.isSwitchedOn) {
        @InlineJs.withFileNameHint(templates.inlineJS.blocking.js.loadFonts().body, "loadFonts.js")
    }

    @if(AsyncCss.isSwitchedOn) {
        // enable non-blocking stylesheets
        // borrows *heavily* from https://github.com/filamentgroup/loadCSS.
        @InlineJs.withFileNameHint(templates.inlineJS.blocking.js.enableStylesheets().body, "enableStylesheets.js")
    }

    @* also delete iPhoneConfidenceCheck inside of facia.js *@
    // cloudwatch beacons
    @InlineJs.withFileNameHint(templates.inlineJS.blocking.js.cloudwatchBeacons(metaData).body, "cloudwatchBeacons.js")

    // curl
    @Html(templates.inlineJS.blocking.js.curl(metaData).body)

    // load the enhanced JS
    @InlineJs.withFileNameHint(templates.inlineJS.blocking.js.bootEnhanced(metaData).body, "bootEnhanced.js")
</script>
