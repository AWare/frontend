$gallery-lightbox-sidebar-width: gs-span(1);
$gallery-lightbox-info-width-desktop: gs-span(4) + $gs-gutter;
$gallery-lightbox-info-width-wide: gs-span(5) + $gs-gutter;
$c-gallery-lightbox-btn: colour(tone-media-2);
$c-gallery-lightbox-btn--active: colour(neutral-2);
$gallery-lightbox-sidebar-breakpoint: desktop;

/* Root element and states
   ========================================================================== */

.gallery-lightbox {
    display: none;
    position: fixed;
    background-color: lighten(colour(tone-media-1), 2.5%);
    overflow: hidden;
    @include box-sizing(border-box);

    @include mq($gallery-lightbox-sidebar-breakpoint) {
        padding-right: $gallery-lightbox-sidebar-width;
        @include transition(padding-right .1s ease-in);
    }
}

.gallery-lightbox--open {
    display: block;
}

.gallery-lightbox--show-info {
    @include mq($gallery-lightbox-sidebar-breakpoint) {
        padding-right: $gallery-lightbox-sidebar-width + $gallery-lightbox-info-width-desktop;

        .gallery-lightbox__info {
            right: $gallery-lightbox-sidebar-width;
        }
    }
    @include mq(wide) {
        padding-right: $gallery-lightbox-sidebar-width + $gallery-lightbox-info-width-wide;
    }

    .gallery-lightbox__info,
    .gallery-lightbox__btn--close {
        display: block;
    }
}

.gallery-lightbox--endslate {
    @include mq($gallery-lightbox-sidebar-breakpoint) {
        padding-right: $gallery-lightbox-sidebar-width;
    }
    .gallery-lightbox__info {
        display: none;
    }
}

.gallery-lightbox--advert {

    .gallery-lightbox__ad {
        display: block;
    }

    .gallery-lightbox__progress,
    .gallery-lightbox__index {
        color: colour(neutral-2);
    }

    .gallery-lightbox__info > * {
        display: none;
    }
}

.gallery-lightbox--loading {

    .gallery-lightbox__progress {
        &:after {
            content: 'loading';
            @include fs-textSans(1);
            color: colour(neutral-8);
            text-align: center;
            display: block;
        }
        > * {
            display: none;
        }
    }

    .gallery-lightbox__loader {
        display: block;
    }
}

.gallery-lightbox--advert .gallery-lightbox__btn--info-button,
.gallery-lightbox--loading .gallery-lightbox__btn--info-button,
.gallery-lightbox--loading .gallery-lightbox__btn--prev,
.gallery-lightbox--loading .gallery-lightbox__btn--next {
    cursor: default;
    background-color: $c-gallery-lightbox-btn !important;

    i {
        opacity: .15;
    }
}

.gallery-lightbox--loading-img .gallery-lightbox__loader {
    display: block;
}

/* Content
   ========================================================================== */

.gallery-lightbox__content {
    width: 100%;
    height: 100%;
    position: relative;
    z-index: 2; // above loader / below sidebar
    @include box-sizing(border-box);
}

.gallery-lightbox__loader {
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    margin: auto;
    z-index: 1; // behind everything
    display: none;
}

.gallery-lightbox__ad {
    display: none;
}

.gallery-lightbox__img {
    max-width: 100%;
    max-height: 100%;
    position: absolute;
    left: 0;
    right: 0;
    margin: auto;
    top: 0;
    bottom: 0;

    @include mq($gallery-lightbox-sidebar-breakpoint) {
        margin: 0 auto;
        @include transform(translateZ(0)); // promote to gpu to stop buggy transition behaviour
    }
}

.gallery-lightbox__preload-img {
    position: absolute;
    visibility: hidden;
}

/* Meta
   ========================================================================== */

.gallery-lightbox__info {
    position: absolute;
    z-index: 2;
    color: colour(neutral-8);
    @include box-sizing(border-box);
    word-wrap: break-word;
    @include fs-textSans(3);
    width: 100%;
    bottom: 0;
    background-color: rgba(51, 51, 51, .9);
    padding: $gs-gutter/2;
    padding-bottom: $gs-gutter*1.5;
    display: none;

    @include mq(tablet) {
        padding-left: $gs-gutter;
        padding-right: gs-span(3);
        padding-top: $gs-gutter;
        padding-bottom: gs-height(1);
    }

    @include mq($gallery-lightbox-sidebar-breakpoint) {
        display: block;
        height: 100%;
        top: 0;
        bottom: auto;
        padding-top: gs-height(2) + $gs-baseline - 2px;
        padding-right: $gs-gutter*2;
        padding-left: $gs-gutter;
        @include transition(right .1s ease-in);
        background-color: colour(tone-media-1);
        right: (-1 * $gallery-lightbox-info-width-desktop) + $gallery-lightbox-sidebar-width;
        width: $gallery-lightbox-info-width-desktop;
    }
    @include mq(wide) {
        padding-right: gs-span(1) + $gs-gutter;
        right: (-1 * $gallery-lightbox-info-width-wide) + $gallery-lightbox-sidebar-width;
        width: $gallery-lightbox-info-width-wide;
    }
}

.gallery-lightbox__img-caption {
    > strong {
        display: block;
        @include fs-headline(3);
        margin-top: 2px;
        @include box-sizing(border-box);
        padding-right: $gs-gutter*2;
        padding-bottom: $gs-baseline;

        @include mq(tablet) {
            @include fs-headline(4, true);
        }

        & + br {
            display: none;
        }
    }

    a {
        color: colour(neutral-8);
        border-bottom: 1px solid colour(neutral-2);
        &:hover {
            color: colour(neutral-9);
            text-decoration: none;
            border-bottom: 1px solid colour(neutral-9);
        }
    }
}

.gallery-lightbox__img-title {
    @include fs-headline(3);
}

.gallery-lightbox__img-credit {
    color: colour(neutral-3);
}

/* Sidebar
   ========================================================================== */

.gallery-lightbox__sidebar {

    @include mq($gallery-lightbox-sidebar-breakpoint) {
        position: absolute;
        height: 100%;
        right: 0;
        width: $gallery-lightbox-sidebar-width;
        z-index: 3; // above content
        border-left: 1px solid colour(tone-media-2);
        background: colour(tone-media-1);
    }
}


.gallery-lightbox__btn--close .gallery-lightbox__btn-body {
    @include icon-button2(close, 44px);
}

.gallery-lightbox__btn--next .gallery-lightbox__btn-body {
    @include icon-button2(right-arrow, 44px);
}

.gallery-lightbox__btn--prev .gallery-lightbox__btn-body {
    @include icon-button2(left-arrow, 44px);
}

.gallery-lightbox__btn--info-button .gallery-lightbox__btn-body {
    @include icon-button2(info, 44px);
}


.gallery-lightbox__btn--next,
.gallery-lightbox__btn--prev,
.gallery-lightbox__btn--info-button {
    display: none; // hide at mobile
}

.gallery-lightbox__btn {
    cursor: pointer;
    padding: 8px;
    @include mq($gallery-lightbox-sidebar-breakpoint) {
        display: block;
    }
}

.gallery-lightbox__btn-body {
    margin: auto;
    background: $c-gallery-lightbox-btn;
    .gallery-lightbox__btn:hover & {
        @include transition(none);
        background: $c-gallery-lightbox-btn--active;
    }
    @include transition(background-color .2s);
}

.gallery-lightbox__btn--close {
    @include mq($to: $gallery-lightbox-sidebar-breakpoint) {
        display: none;
        position: absolute;
        top: 0;
        right: 0;
        z-index: 4; // above img/sidebar
        padding: $gs-baseline/2 $gs-gutter/2 $gs-gutter $gs-gutter;

        .gallery-lightbox__btn-body {
            background-color: rgba(51, 51, 51, .6);
            border: 1px solid colour(neutral-4);
        }
    }
    .gallery-lightbox__btn--close-hitbox:hover & {
        @include transition(none);
        background: $c-gallery-lightbox-btn--active;
    }
}

.gallery-lightbox__btn-hitbox {
    cursor: pointer;
    padding: $gs-baseline/1.5;
}

.gallery-lightbox__button-pulse .gallery-lightbox__btn-body {
    @include transition(none);
    background-color: $c-gallery-lightbox-btn--active;
}

.gallery-lightbox__progress {
    color: colour(neutral-3);
    @include fs-textSans(1);
    display: none;
}

.gallery-lightbox__progress--info {
    @include mq($to: $gallery-lightbox-sidebar-breakpoint) {
        display: block;
    }
}
.gallery-lightbox__progress--sidebar {
    @include mq($gallery-lightbox-sidebar-breakpoint) {
        display: block;
        text-align: center;
        padding-top: $gs-baseline * 3;
    }
}

.gallery-lightbox__progress-separator {
    &:after {
        content: ' / ';
        display: inline;
    }
}

.gallery-lightbox__index {
    color: colour(neutral-8);
}

/* Endslate
   ========================================================================== */

.gallery-lightbox--endslate {
    background-color: $c-neutral1;
}

.gallery-lightbox__endslate {
    display: none;
    width: gs-span(9) + $gs-gutter*2;
    margin: 0 auto;
    margin-top: gs-height(1);

    @include mq(tablet) {
        display: block;
    }

    @include mq(leftCol) {
        width: gs-span(12) + $gs-gutter*2;

        .container__body {
            margin-left: 0 !important;
        }
    }

    .row-of-two--boost-first .facia-slice__item:nth-child(1) {
        @include mq(desktop, leftCol) {

            .item__media-wrapper {
                width: gs-span(4) + $gs-gutter*2;
            }

            .item__title {
                @include fs-headline(3, true);
            }
        }
    }

    &.gallery-lightbox__endslate--is-hidden {
        display: none;
    }

    .l-side-margins {
        display: block;
    }

    .container__border {
        display: none;
    }

    .container__header {
        border-bottom: 1px solid $c-neutral2;
    }
}

