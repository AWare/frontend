@(article: Article, related: List[Trail])
@import fragments._
@import conf._

<!DOCTYPE html>

<html>

<head>
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
    <meta charset="utf-8" />

    <script>
        var guardian = {};
    </script>
    @fragments.metaData(article)

    <title>@article.headline</title>

    <link rel="shortcut icon" type="image/png" href="@controllers.Static.at("images/favicon.png")">

    <link rel="stylesheet" media="screen" type="text/css" href="http://2.gu-pasteup.appspot.com/css/pasteup.css" />

    <!-- Add layout styles for browsers over 400px or less than IE9, but not IE mobile or IE6. -->
    <link rel="stylesheet" media="screen and (min-width: 400px)" href="@controllers.Static.at("stylesheets/grid.responsive.css")">

    <link rel="stylesheet" type="text/css" href="@controllers.Static.at("stylesheets/main.css")">

    <!--[if (lt IE 9) & (!IEMobile) & (gt IE6)]>
        <link rel="stylesheet" type="text/css" href="@controllers.Static.at("stylesheets/grid.responsive.css")">
    <![endif]-->

    <script data-main="@controllers.Static.at("javascripts/main.min.js")" src="http://3.gu-pasteup.appspot.com/js/require.js"></script>


</head>

<body>

    <div id="container">

        <div class="line">

            <div class="unit size1of1">

                    @fragments.headline(article.headline)
                    @fragments.standfirst(article.standfirst)

                    @article.images.find( i => i.rel == "alt-size" && i.width > 140 && i.width < 250).map{ image =>
                        <img style="width: 100%;" src="@image.url" data-fullsrc='@article.images.find(_.rel == "body").map { full => @full.url }' data-width="@image.width" />
                        @fragments.caption(image.caption.getOrElse(""))
                    }

                    @fragments.byline(article.byline)
                    @fragments.dateline(article.webPublicationDate)
                
                    <article>
                        @Html(article.body)
                    </article>

            </div>
            <div class="unit size1of3 lastUnit">
                <ul>
                @related.map{ trail =>
                <li>@fragments.formatTrail(trail)</li>
                }
                </ul>

            </div>
        </div>

    </div>

    <div id="debug">
        <strong>debug info</strong>
        <ul>
            <li>Screen height: <span id="screenHeight"></span></li>
            <li>Screen width: <span id="screenWidth"></span></li>
            <li>Window height: <span id="windowHeight"></span></li>
            <li>Window width: <span id="windowWidth"></span></li>
            <li>Layout mode: <span id="layout"></span></li>
            <li>Connection Speed: <span id="bandwidth"></span></li>
            <li>Battery: <span id="battery"></span></li>
            <li>Pixel Ratio: <span id="pixelratio"></span></li>
            <li>Retina display: <span id="retina"></span></li>
        </ul>
    </div>

    <script>
        require(['@Configuration.plugins.location'], function(){});
    </script>
</body>
</html>
